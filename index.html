<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Outlet Photo Slide</title>
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f0f2f5; display: flex; flex-direction: column; min-height: 100vh; }

    /* HEADER */
    header {
      display: flex;
      align-items: center;
      background: #ffffff;
      color: #0a2d6d;
      padding: 12px 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    header img {
      height: 40px;
      font-weight: 500;
      margin-right: 15px;
    }
    header h1 {
      font-size: 20px;
      text-align: center;
      margin: 0;
    }

    /* MAIN CONTENT */
    main {
      flex: 1;
      padding: 20px;
    }

    h2 { text-align: center; }

    .grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-gap: 12px;
      margin-top: 20px;
    }
    .card {
      position: relative;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      overflow: hidden;
      text-align: center;
      height: 200px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .card img {
      max-width: 100%;
      height: 150px;
      object-fit: cover;
    }
    .label {
      background: #0a2d6d;
      color: #fff;
      padding: 5px;
      font-weight: bold;
      text-align: center;
      font-size: 14px;
    }
    .upload { margin: 10px 0; text-align: center; }
    .upload input { margin: 5px; }
    .controls { text-align: center; margin-top: 20px; }
    button {
      padding: 10px 20px;
      border: none;
      color: #fff;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin: 5px;
    }
    button:hover { opacity: 0.9; }
    .btn-add { background: #2563eb; }     /* Blue */
    .btn-del-slide { background: #dc2626; } /* Red */
    .btn-del-all { background: #f97316; } /* Orange */
    .btn-download { background: #16a34a; } /* Green */
    .slides-nav {
      text-align: center;
      margin: 15px 0;
    }
    .slides-nav button {
      padding: 6px 12px;
      margin: 3px;
      border-radius: 4px;
      background: #e5e7eb;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    .slides-nav button.active {
      background: #2563eb;
      color: #fff;
      border-color: #1e40af;
    }

    /* FOOTER */
    footer {
      background: #0a2d6d;
      color: #fff;
      text-align: center;
      padding: 10px;
      font-size: 14px;
      margin-top: auto;
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header>
        <img src="netcorp.jpg" alt="Logo">
    <img src="RFM LOGO.jpg?text=LOGO" alt="Logo">

    <h1>Outlet Slide Creator</h1>
  </header>

  <main>
    <h2>Upload photos and type outlet names (10 per slide)</h2>
    
    <div class="upload">
      <div id="inputs"></div>
    </div>
    
    <div class="slides-nav" id="slidesNav"></div>

    <div class="grid" id="slideGrid"></div>

    <div class="controls">
      <button class="btn-add" onclick="addNewSlide()">‚ûï Add New Slide</button>
      <button class="btn-del-all" onclick="deleteAllSlides()">üóë Delete All Slides</button>
      <button class="btn-del-slide" onclick="deleteCurrentSlide()">üóë Delete Current Slide</button>
      <button class="btn-download" onclick="downloadPPT()">‚¨áÔ∏è Download PPTX</button>
    </div>
  </main>

  <!-- FOOTER -->
  <footer>
    ¬© 2025 Outlet Slide Creator. All rights reserved.
  </footer>
  
  <script>
    const grid = document.getElementById("slideGrid");
    const inputs = document.getElementById("inputs");
    const slidesNav = document.getElementById("slidesNav");

    let slidesData = []; // array of slides, each with 10 outlets
    let currentSlideIndex = 0;

    function createEmptySlide() {
      return Array.from({ length: 10 }, () => ({ img: null, name: "" }));
    }

    function addNewSlide() {
      slidesData.push(createEmptySlide());
      currentSlideIndex = slidesData.length - 1;
      renderNav();
      renderInputs();
      renderGrid();
    }

    function switchSlide(index) {
      currentSlideIndex = index;
      renderNav();
      renderInputs();
      renderGrid();
    }

    function deleteCurrentSlide() {
      if (!confirm("Are you sure you want to delete this slide?")) return;
      if (slidesData.length === 1) {
        alert("At least one slide is required!");
        return;
      }
      slidesData.splice(currentSlideIndex, 1);
      currentSlideIndex = Math.max(0, currentSlideIndex - 1);
      renderNav();
      renderInputs();
      renderGrid();
    }

    function deleteAllSlides() {
      if (!confirm("‚ö† This will delete ALL slides. Continue?")) return;
      slidesData = [createEmptySlide()]; // reset with one empty slide
      currentSlideIndex = 0;
      renderNav();
      renderInputs();
      renderGrid();
    }

    function renderNav() {
      slidesNav.innerHTML = "";
      slidesData.forEach((_, i) => {
        const btn = document.createElement("button");
        btn.textContent = `Slide ${i + 1}`;
        btn.className = (i === currentSlideIndex) ? "active" : "";
        btn.onclick = () => switchSlide(i);
        slidesNav.appendChild(btn);
      });
    }

    function renderGrid() {
      grid.innerHTML = "";
      slidesData[currentSlideIndex].forEach((out, i) => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          ${out.img ? `<img src="${out.img}" alt="Outlet ${i+1}">` : ""}
          <div class="label">${out.name || "STORE NAME"}</div>
        `;
        grid.appendChild(card);
      });
    }

    function renderInputs() {
      inputs.innerHTML = "";
      slidesData[currentSlideIndex].forEach((out, i) => {
        const div = document.createElement("div");
        div.innerHTML = `
          <input type="file" accept="image/*" onchange="uploadImage(event, ${i})">
          <input type="text" placeholder="Outlet Name" value="${out.name}" oninput="updateName(${i}, this.value)">
        `;
        inputs.appendChild(div);
      });
    }

    function uploadImage(e, index) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(ev) {
        slidesData[currentSlideIndex][index].img = ev.target.result;
        renderGrid();
      };
      reader.readAsDataURL(file);
    }

    function updateName(index, name) {
      slidesData[currentSlideIndex][index].name = name;
      renderGrid();
    }

    async function downloadPPT() {
      let pptx = new PptxGenJS();

      slidesData.forEach(outlets => {
        let slide = pptx.addSlide();
        const cols = 5;
        const rows = 2;
        const cellW = 1.87; 
        const cellH = 2.7;
        const marginX = 0.1;
        const marginY = 0.1;

        outlets.forEach((out, i) => {
          const row = Math.floor(i / cols);
          const col = i % cols;
          const x = marginX + col * (cellW + 0.1);
          const y = marginY + row * (cellH + 0.1);

          if (out.img) {
            slide.addImage({ data: out.img, x, y, w: cellW, h: cellH - 0.4 });
          } else {
            // leave empty if no image
            slide.addShape(pptx.ShapeType.rect, { x, y, w: cellW, h: cellH-0.4, fill: { color: "F3F4F6" } });
            slide.addText("No Image", { x, y, w: cellW, h: cellH-0.4, align: "center", valign: "middle", color:"555", fontSize:12 });
          }

          slide.addText(out.name || "Outlet Name", {
            x, y: y + (cellH - 0.4), w: cellW, h: 0.4,
            bold: true, color: "FFFFFF", fontSize: 12,
            fill: { color: "0A2D6D" }, align: "center", valign:"middle"
          });
        });
      });

      await pptx.writeFile({ fileName: "Outlet-Slides.pptx" });
    }

    // start with one empty slide
    addNewSlide();
  </script>
</body>
</html>


